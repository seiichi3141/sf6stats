# 画面選技図・画面構成（案）

## 画面一覧

- トップ/使用率ダッシュボード（全体・マスター切替）
- 対戦ダイヤグラム（全体・マスター切替）
- キャラ詳細（使用率カード + マッチアップリスト）
- メタ比較（全体 vs マスターの差分ビュー）

## 画面遷移（概略）

- `トップ` → キャラカードの「詳細を見る」で `キャラ詳細` へ遷移。
- `トップ` → 「対戦ダイヤを見る」で `対戦ダイヤグラム` へ遷移。
- `対戦ダイヤグラム` → ヒートマップのキャラ行/列選択で `キャラ詳細` へ遷移。
- `メタ比較` はトップのサブタブとして表示し、キャラ名クリックで `キャラ詳細` へ。

## 画面構成

### トップ/使用率ダッシュボード

- ヘッダー: 期間セレクタ（年月）、モード切替（全体/マスター）、最終更新表示。
- 使用率ランキング: `play_rate` ソート、`previous_rate` との差分を矢印・色で表示。キャラアイコン + パーセント。
- 使用率 × パフォーマンス: `_dsort` 平均（ダイヤ勝率相当）と `play_rate` の散布/表。人気と勝率のズレをハイライト。
- ショートカット: 有利/不利トップ3へのリンク（`records.values` から抽出）。

### 対戦ダイヤグラム

- ヘッダー: 期間、モード（全体=`ci_sort` / マスター=`c.ci_sort`）、凡例（有利>0.55, 五分0.45-0.55, 不利<0.45）。
- ヒートマップ: 行=キャラ、列=対戦相手、セルに `_dsort` と `val`（文字列）。ソート: 選択キャラの有利/不利順。
- 有利/不利リスト: 選択キャラの `records.values` を `_dsort` で昇降順上位N件表示。`sf`/`thm` フラグもバッジ化。
- キャラ切替: セレクト or タブ。クリックで `キャラ詳細` へ。

### キャラ詳細

- 基本情報: キャラ名・アイコン。モード切替（全体/マスター）。
- 使用率カード: `play_rate` と `previous_rate` 差分、`count` を補足。
- マッチアップ表: `records.values` をテーブル/リストで `_dsort` ソート。フィルタ: 有利/五分/不利。
- ハイライト: マスターと全体の `_dsort` 差分を棒グラフで表示（同キャラID間で比較）。

### メタ比較（全体 vs マスター）

- 差分ランキング: `play_rate` 差分の大きいキャラ順。
- 勝率差分: `_dsort` の全体 vs マスター差分を横棒で表示。
- ショートリンク: キャラ名クリックで詳細へ。

## データ依存関係（表示に使用する主なフィールド）

- 使用率: `usagerateData[].val[].val[]` → `play_rate`, `previous_rate`, `count`.
- ダイヤ: `diaData.ci.ci_sort`（全体）, `diaData.c.ci_sort`（マスター）→ `opponent_header`, `records[].values[]. _dsort`, `val`, `sf`, `thm`.

## 補足

- 期間切替: URL の年月パスを利用。デフォルトは最新月（例: 202509）。
- 表示崩れ対策: ヒートマップは横スクロール/縮小、モバイルはリスト優先。
